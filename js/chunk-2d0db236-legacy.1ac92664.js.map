{"version":3,"sources":["webpack:///./src/views/Tweet.vue?e6d3","webpack:///./src/components/TweetReplyCard.vue?66cc","webpack:///src/components/TweetReplyCard.vue","webpack:///./src/components/TweetReplyCard.vue?6610","webpack:///./src/components/TweetReplyCard.vue","webpack:///src/views/Tweet.vue","webpack:///./src/views/Tweet.vue?1381","webpack:///./src/views/Tweet.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","$event","$router","back","_v","linkedUser","user","id","attrs","_f","avatar","_s","name","account","repliedTweet","description","createdAt","replyCards","length","likeCount","showReplyModal","deleteLike","addLike","_l","replyCard","key","staticRenderFns","userId","userName","userAccount","targetUserId","targetAccount","comment","mixins","props","replyTarget","type","required","data","tweetId","computed","mapState","methods","fetchReplyCard","UserId","User","currentUser","push","params","created","watch","newValue","component","components","TweetReplyCard","paramsId","isLoading","isProcessing","fetchRepliedTweet","tweetsAPI","statusText","Toast","icon","title","fetchTweetReplyCards","afterSubmitReplyCreate","unshift","$modal","show","$store","commit","replyTargetData","Number","beforeRouteUpdate","to","from","next","replyCreate"],"mappings":"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","file":"js/chunk-2d0db236-legacy.1ac92664.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.isLoading)?_c('img',{staticClass:\"spinner\"}):_c('div',[_c('div',{staticClass:\"tweet-wrapper\"},[_c('div',{staticClass:\"tweet-title\"},[_c('img',{staticClass:\"arrow\",on:{\"click\":function($event){return _vm.$router.back()}}}),_c('h3',[_vm._v(\"推文\")])]),_c('div',{staticClass:\"tweet-main\"},[_c('div',{staticClass:\"card-head\"},[_c('div',{staticClass:\"card-head-left avatar\",on:{\"click\":function($event){return _vm.linkedUser(_vm.user.id)}}},[_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm._f(\"emptyImage\")(_vm.user.avatar)}})]),_c('div',{staticClass:\"card-head-right\"},[_c('h5',{on:{\"click\":function($event){return _vm.linkedUser(_vm.user.id)}}},[_vm._v(_vm._s(_vm.user.name))]),_c('h5',[_vm._v(_vm._s(_vm._f(\"accountTag\")(_vm.user.account)))])])]),_c('div',{staticClass:\"tweet-body\"},[_c('p',[_vm._v(_vm._s(_vm.repliedTweet.description))]),_c('h5',[_vm._v(_vm._s(_vm._f(\"timeFormat\")(_vm.repliedTweet.createdAt)))])]),_c('div',{staticClass:\"tweet-footer\"},[_c('div',{staticClass:\"tweet-footer-info\"},[_c('h4',[_c('strong',[_vm._v(_vm._s(_vm.replyCards.length))]),_vm._v(\" 回覆 \")]),_c('h4',[_c('strong',[_vm._v(_vm._s(_vm.repliedTweet.likeCount))]),_vm._v(\" 喜歡次數 \")])]),_c('div',{staticClass:\"tweet-footer-buttons\"},[_c('img',{staticClass:\"reply-big\",on:{\"click\":function($event){return _vm.showReplyModal()}}}),(_vm.repliedTweet.isLiked)?_c('img',{staticClass:\"heart-big-active\",on:{\"click\":function($event){return _vm.deleteLike()}}}):_c('img',{staticClass:\"heart-big\",on:{\"click\":function($event){return _vm.addLike()}}})])])])]),_vm._l((_vm.replyCards),function(replyCard){return _c('div',{key:replyCard.id,staticClass:\"tweet-replies\"},[_c('TweetReplyCard',{attrs:{\"reply-target\":_vm.user,\"reply-card\":replyCard}})],1)})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tweetReplyCard-wrapper\"},[_c('div',{staticClass:\"card-left avatar\",on:{\"click\":function($event){return _vm.linkedUser(_vm.userId)}}},[_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm._f(\"emptyImage\")(_vm.avatar)}})]),_c('div',{staticClass:\"card-right\"},[_c('div',{staticClass:\"card-head\"},[_c('h5',{staticClass:\"card-name\",on:{\"click\":function($event){return _vm.linkedUser(_vm.userId)}}},[_vm._v(\" \"+_vm._s(_vm.userName)+\" \")]),_c('h5',{staticClass:\"card-account\"},[_vm._v(\" \"+_vm._s(_vm._f(\"accountTag\")(_vm.userAccount))+\" \")]),_c('span',[_vm._v(\"．\")]),_c('h5',{staticClass:\"card-time\"},[_vm._v(\" \"+_vm._s(_vm._f(\"fromNow\")(_vm.createdAt))+\" \")])]),_c('h5',[_c('span',[_vm._v(\"回覆\")]),_c('span',{staticClass:\"card-replyer\",on:{\"click\":function($event){return _vm.linkedUser(_vm.targetUserId)}}},[_vm._v(\" \"+_vm._s(_vm._f(\"accountTag\")(_vm.targetAccount))+\" \")])]),_c('p',[_vm._v(_vm._s(_vm.comment))])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"tweetReplyCard-wrapper\">\r\n    <div class=\"card-left avatar\" @click=\"linkedUser(userId)\">\r\n      <img class=\"avatar\" :src=\"avatar | emptyImage\" />\r\n    </div>\r\n    <div class=\"card-right\">\r\n      <div class=\"card-head\">\r\n        <h5 class=\"card-name\" @click=\"linkedUser(userId)\">\r\n          {{ userName }}\r\n        </h5>\r\n        <h5 class=\"card-account\">\r\n          {{ userAccount | accountTag }}\r\n        </h5>\r\n        <span>．</span>\r\n        <h5 class=\"card-time\">\r\n          {{ createdAt | fromNow }}\r\n        </h5>\r\n      </div>\r\n      <h5>\r\n        <span>回覆</span>\r\n        <span class=\"card-replyer\" @click=\"linkedUser(targetUserId)\">\r\n          {{ targetAccount | accountTag }}\r\n        </span>\r\n      </h5>\r\n      <p>{{ comment }}</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  fromNowFilter,\r\n  accountTagFilter,\r\n  emptyImageFilter,\r\n} from \"../utils/mixins\";\r\nimport { mapState } from \"vuex\";\r\n\r\nexport default {\r\n  mixins: [fromNowFilter, accountTagFilter, emptyImageFilter],\r\n  props: {\r\n    // 被回覆者的資料\r\n    replyTarget: {\r\n      type: Object,\r\n      required: true,\r\n    },\r\n    // 每筆回覆貼文的資料\r\n    replyCard: {\r\n      type: Object,\r\n      required: true,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      // 被回覆的對象\r\n      targetAccount: \"\",\r\n      targetUserId: 0,\r\n      // 此卡片的其他資料\r\n      tweetId: 0,\r\n      userId: 0,\r\n      comment: \"\",\r\n      createdAt: \"\",\r\n      userName: \"\",\r\n      userAccount: \"\",\r\n      avatar: \"\",\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"currentUser\"]),\r\n  },\r\n  methods: {\r\n    fetchReplyCard() {\r\n      // 被回覆的對象\r\n      this.targetAccount = this.replyTarget.account;\r\n      this.targetUserId = this.replyTarget.id;\r\n      // 此卡片的其他資料\r\n      const { id, comment, createdAt, UserId, User } = this.replyCard;\r\n      this.tweetId = id;\r\n      this.userId = UserId;\r\n      this.comment = comment;\r\n      this.createdAt = createdAt;\r\n      this.userName = User.name;\r\n      this.userAccount = User.account;\r\n      this.avatar = User.avatar;\r\n    },\r\n    linkedUser(userId) {\r\n      if (userId === this.currentUser.id) {\r\n        this.$router.push({ name: \"self\" });\r\n      } else {\r\n        this.$router.push({ name: \"other\", params: { id: userId } });\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    this.fetchReplyCard();\r\n  },\r\n  watch: {\r\n    replyCard(newValue) {\r\n      this.replyCard = newValue;\r\n      this.fetchReplyCard();\r\n    },\r\n    replyTarget(newValue) {\r\n      this.replyTarget = newValue;\r\n      this.fetchReplyCard();\r\n    },\r\n  },\r\n};\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TweetReplyCard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TweetReplyCard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TweetReplyCard.vue?vue&type=template&id=80570670&\"\nimport script from \"./TweetReplyCard.vue?vue&type=script&lang=js&\"\nexport * from \"./TweetReplyCard.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div>\r\n    <img v-if=\"isLoading\" class=\"spinner\" />\r\n    <div v-else>\r\n      <div class=\"tweet-wrapper\">\r\n        <div class=\"tweet-title\">\r\n          <img @click=\"$router.back()\" class=\"arrow\" />\r\n          <h3>推文</h3>\r\n        </div>\r\n        <div class=\"tweet-main\">\r\n          <div class=\"card-head\">\r\n            <div class=\"card-head-left avatar\" @click=\"linkedUser(user.id)\">\r\n              <img class=\"avatar\" :src=\"user.avatar | emptyImage\" />\r\n            </div>\r\n            <div class=\"card-head-right\">\r\n              <h5 @click=\"linkedUser(user.id)\">{{ user.name }}</h5>\r\n              <h5>{{ user.account | accountTag }}</h5>\r\n            </div>\r\n          </div>\r\n          <div class=\"tweet-body\">\r\n            <p>{{ repliedTweet.description }}</p>\r\n            <h5>{{ repliedTweet.createdAt | timeFormat }}</h5>\r\n          </div>\r\n          <div class=\"tweet-footer\">\r\n            <div class=\"tweet-footer-info\">\r\n              <h4>\r\n                <strong>{{ replyCards.length }}</strong> 回覆\r\n              </h4>\r\n              <h4>\r\n                <strong>{{ repliedTweet.likeCount }}</strong> 喜歡次數\r\n              </h4>\r\n            </div>\r\n            <div class=\"tweet-footer-buttons\">\r\n              <img class=\"reply-big\" @click=\"showReplyModal()\" />\r\n              <img\r\n                v-if=\"repliedTweet.isLiked\"\r\n                @click=\"deleteLike()\"\r\n                class=\"heart-big-active\"\r\n              />\r\n              <img v-else @click=\"addLike()\" class=\"heart-big\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div\r\n        class=\"tweet-replies\"\r\n        v-for=\"replyCard in replyCards\"\r\n        :key=\"replyCard.id\"\r\n      >\r\n        <TweetReplyCard :reply-target=\"user\" :reply-card=\"replyCard\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport TweetReplyCard from \"../components/TweetReplyCard.vue\";\r\nimport tweetsAPI from \"../apis/tweets\";\r\nimport { mapState } from \"vuex\";\r\nimport {\r\n  accountTagFilter,\r\n  timeFormatFilter,\r\n  emptyImageFilter,\r\n} from \"../utils/mixins\";\r\nimport { Toast } from \"../utils/helpers\";\r\n\r\nexport default {\r\n  name: \"Tweet\",\r\n  components: {\r\n    TweetReplyCard,\r\n  },\r\n  mixins: [accountTagFilter, timeFormatFilter, emptyImageFilter],\r\n  computed: {\r\n    ...mapState([\"currentUser\", \"replyCreate\"]),\r\n  },\r\n  data() {\r\n    return {\r\n      paramsId: 0,\r\n      user: {},\r\n      repliedTweet: {},\r\n      replyCards: [],\r\n      isLoading: false,\r\n      isProcessing: false,\r\n    };\r\n  },\r\n  methods: {\r\n    async fetchRepliedTweet(paramsId) {\r\n      // 主貼文資料：\r\n      try {\r\n        this.isLoading = true;\r\n        const { data, statusText } = await tweetsAPI.getRepliedTweet({\r\n          tweetId: paramsId,\r\n        });\r\n        if (statusText !== \"OK\") throw new Error(statusText);\r\n        this.isLoading = false;\r\n        this.user = data.User;\r\n        this.repliedTweet = { ...data };\r\n      } catch (error) {\r\n        this.isLoading = false;\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法取得推文內容，請稍後再試\",\r\n        });\r\n      }\r\n    },\r\n    async fetchTweetReplyCards(paramsId) {\r\n      // 所有回覆卡片的陣列\r\n      try {\r\n        this.isLoading = true;\r\n        const { data, statusText } = await tweetsAPI.getAllReplies({\r\n          tweetId: paramsId,\r\n        });\r\n        if (statusText !== \"OK\") throw new Error(statusText);\r\n        this.isLoading = false;\r\n        this.replyCards = [...data];\r\n      } catch (error) {\r\n        this.isLoading = false;\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法取得回覆推文，請稍後再試\",\r\n        });\r\n      }\r\n    },\r\n    afterSubmitReplyCreate(data) {\r\n      this.replyCards.unshift({\r\n        comment: data.comment,\r\n        id: data.id,\r\n        createdAt: data.createdAt,\r\n        User: {\r\n          avatar: this.currentUser.avatar,\r\n          account: this.currentUser.account,\r\n          name: this.currentUser.name,\r\n        },\r\n      });\r\n    },\r\n    async addLike() {\r\n      try {\r\n        this.isProcessing = true;\r\n        const { statusText, data } = await tweetsAPI.addLike({\r\n          tweetId: this.paramsId,\r\n        });\r\n        if (statusText !== \"OK\" || data.status !== \"success\")\r\n          throw new Error(statusText);\r\n        this.isProcessing = false;\r\n        this.repliedTweet.isLiked = true;\r\n        this.repliedTweet.likeCount++;\r\n      } catch (error) {\r\n        this.isProcessing = false;\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法加入最愛，請稍後再試\",\r\n        });\r\n      }\r\n    },\r\n    async deleteLike() {\r\n      try {\r\n        this.isProcessing = true;\r\n        const { statusText, data } = await tweetsAPI.deleteLike({\r\n          tweetId: this.paramsId,\r\n        });\r\n        if (statusText !== \"OK\" || data.status !== \"success\")\r\n          throw new Error(statusText);\r\n        this.isProcessing = false;\r\n        this.repliedTweet.isLiked = false;\r\n        this.repliedTweet.likeCount--;\r\n      } catch (error) {\r\n        this.isProcessing = false;\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法取消最愛，請稍後再試\",\r\n        });\r\n      }\r\n    },\r\n    linkedUser(userId) {\r\n      if (userId === this.currentUser.id) {\r\n        this.$router.push({ name: \"self\" });\r\n      } else {\r\n        this.$router.push({ name: \"other\", params: { id: userId } });\r\n      }\r\n    },\r\n    showReplyModal() {\r\n      this.$modal.show(\"replyCreate\");\r\n      const { id, User, description, createdAt } = this.repliedTweet;\r\n      const replyTargetData = {\r\n        id,\r\n        name: User.name,\r\n        userId: User.id,\r\n        account: User.account,\r\n        avatar: User.avatar,\r\n        description,\r\n        createdAt,\r\n      };\r\n      this.$store.commit(\"setTweetReplyTarget\", replyTargetData);\r\n    },\r\n  },\r\n  created() {\r\n    const { id } = this.$route.params;\r\n    this.paramsId = Number(id);\r\n    this.fetchRepliedTweet(this.paramsId);\r\n    this.fetchTweetReplyCards(this.paramsId);\r\n  },\r\n  beforeRouteUpdate(to, from, next) {\r\n    const { id } = to.params;\r\n    this.paramsId = Number(id);\r\n    this.fetchRepliedTweet(this.paramsId);\r\n    this.fetchTweetReplyCards(this.paramsId);\r\n    next();\r\n  },\r\n  watch: {\r\n    replyCreate(newValue) {\r\n      this.afterSubmitReplyCreate(newValue);\r\n    },\r\n  },\r\n};\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tweet.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tweet.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tweet.vue?vue&type=template&id=c40c84ea&\"\nimport script from \"./Tweet.vue?vue&type=script&lang=js&\"\nexport * from \"./Tweet.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}